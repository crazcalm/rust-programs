<!DOCTYPE HTML>
<html lang="en" class="light sidebar-visible" dir="ltr">
    <head>
        <!-- Book generated using mdBook -->
        <meta charset="UTF-8">
        <title>Chapter 2 - Rust Programs</title>


        <!-- Custom HTML head -->

        <meta name="description" content="">
        <meta name="viewport" content="width=device-width, initial-scale=1">
        <meta name="theme-color" content="#ffffff">

        <link rel="icon" href="../favicon.svg">
        <link rel="shortcut icon" href="../favicon.png">
        <link rel="stylesheet" href="../css/variables.css">
        <link rel="stylesheet" href="../css/general.css">
        <link rel="stylesheet" href="../css/chrome.css">
        <link rel="stylesheet" href="../css/print.css" media="print">

        <!-- Fonts -->
        <link rel="stylesheet" href="../FontAwesome/css/font-awesome.css">
        <link rel="stylesheet" href="../fonts/fonts.css">

        <!-- Highlight.js Stylesheets -->
        <link rel="stylesheet" href="../highlight.css">
        <link rel="stylesheet" href="../tomorrow-night.css">
        <link rel="stylesheet" href="../ayu-highlight.css">

        <!-- Custom theme stylesheets -->


        <!-- Provide site root to javascript -->
        <script>
            var path_to_root = "../";
            var default_theme = window.matchMedia("(prefers-color-scheme: dark)").matches ? "navy" : "light";
        </script>
        <!-- Start loading toc.js asap -->
        <script src="../toc.js"></script>
    </head>
    <body>
    <div id="body-container">
        <!-- Work around some values being stored in localStorage wrapped in quotes -->
        <script>
            try {
                var theme = localStorage.getItem('mdbook-theme');
                var sidebar = localStorage.getItem('mdbook-sidebar');

                if (theme.startsWith('"') && theme.endsWith('"')) {
                    localStorage.setItem('mdbook-theme', theme.slice(1, theme.length - 1));
                }

                if (sidebar.startsWith('"') && sidebar.endsWith('"')) {
                    localStorage.setItem('mdbook-sidebar', sidebar.slice(1, sidebar.length - 1));
                }
            } catch (e) { }
        </script>

        <!-- Set the theme before any content is loaded, prevents flash -->
        <script>
            var theme;
            try { theme = localStorage.getItem('mdbook-theme'); } catch(e) { }
            if (theme === null || theme === undefined) { theme = default_theme; }
            const html = document.documentElement;
            html.classList.remove('light')
            html.classList.add(theme);
            html.classList.add("js");
        </script>

        <input type="checkbox" id="sidebar-toggle-anchor" class="hidden">

        <!-- Hide / unhide sidebar before it is displayed -->
        <script>
            var sidebar = null;
            var sidebar_toggle = document.getElementById("sidebar-toggle-anchor");
            if (document.body.clientWidth >= 1080) {
                try { sidebar = localStorage.getItem('mdbook-sidebar'); } catch(e) { }
                sidebar = sidebar || 'visible';
            } else {
                sidebar = 'hidden';
            }
            sidebar_toggle.checked = sidebar === 'visible';
            html.classList.remove('sidebar-visible');
            html.classList.add("sidebar-" + sidebar);
        </script>

        <nav id="sidebar" class="sidebar" aria-label="Table of contents">
            <!-- populated by js -->
            <mdbook-sidebar-scrollbox class="sidebar-scrollbox"></mdbook-sidebar-scrollbox>
            <noscript>
                <iframe class="sidebar-iframe-outer" src="../toc.html"></iframe>
            </noscript>
            <div id="sidebar-resize-handle" class="sidebar-resize-handle">
                <div class="sidebar-resize-indicator"></div>
            </div>
        </nav>

        <div id="page-wrapper" class="page-wrapper">

            <div class="page">
                <div id="menu-bar-hover-placeholder"></div>
                <div id="menu-bar" class="menu-bar sticky">
                    <div class="left-buttons">
                        <label id="sidebar-toggle" class="icon-button" for="sidebar-toggle-anchor" title="Toggle Table of Contents" aria-label="Toggle Table of Contents" aria-controls="sidebar">
                            <i class="fa fa-bars"></i>
                        </label>
                        <button id="theme-toggle" class="icon-button" type="button" title="Change theme" aria-label="Change theme" aria-haspopup="true" aria-expanded="false" aria-controls="theme-list">
                            <i class="fa fa-paint-brush"></i>
                        </button>
                        <ul id="theme-list" class="theme-popup" aria-label="Themes" role="menu">
                            <li role="none"><button role="menuitem" class="theme" id="light">Light</button></li>
                            <li role="none"><button role="menuitem" class="theme" id="rust">Rust</button></li>
                            <li role="none"><button role="menuitem" class="theme" id="coal">Coal</button></li>
                            <li role="none"><button role="menuitem" class="theme" id="navy">Navy</button></li>
                            <li role="none"><button role="menuitem" class="theme" id="ayu">Ayu</button></li>
                        </ul>
                        <button id="search-toggle" class="icon-button" type="button" title="Search. (Shortkey: s)" aria-label="Toggle Searchbar" aria-expanded="false" aria-keyshortcuts="S" aria-controls="searchbar">
                            <i class="fa fa-search"></i>
                        </button>
                    </div>

                    <h1 class="menu-title">Rust Programs</h1>

                    <div class="right-buttons">
                        <a href="../print.html" title="Print this book" aria-label="Print this book">
                            <i id="print-button" class="fa fa-print"></i>
                        </a>

                    </div>
                </div>

                <div id="search-wrapper" class="hidden">
                    <form id="searchbar-outer" class="searchbar-outer">
                        <input type="search" id="searchbar" name="searchbar" placeholder="Search this book ..." aria-controls="searchresults-outer" aria-describedby="searchresults-header">
                    </form>
                    <div id="searchresults-outer" class="searchresults-outer hidden">
                        <div id="searchresults-header" class="searchresults-header"></div>
                        <ul id="searchresults">
                        </ul>
                    </div>
                </div>

                <!-- Apply ARIA attributes after the sidebar and the sidebar toggle button are added to the DOM -->
                <script>
                    document.getElementById('sidebar-toggle').setAttribute('aria-expanded', sidebar === 'visible');
                    document.getElementById('sidebar').setAttribute('aria-hidden', sidebar !== 'visible');
                    Array.from(document.querySelectorAll('#sidebar a')).forEach(function(link) {
                        link.setAttribute('tabIndex', sidebar === 'visible' ? 0 : -1);
                    });
                </script>

                <div id="content" class="content">
                    <main>
                        <h1 id="chapter-2"><a class="header" href="#chapter-2">Chapter 2</a></h1>
<p>This chapter is an introductory chapter used to justify the use of C as the languaged used in this book. Post that, it goes over a single example with the purpose of introducing the C programming language to the reader.</p>
<h2 id="example-euclids-algorithm"><a class="header" href="#example-euclids-algorithm">Example: Euclid's Algorithm</a></h2>
<p>To begin, we'll consider a C program to solve a classic elementary problem: "Reduce a given fraction to its lowest to its lowest terms." We want to write 2/3, not 4/6, 200/300. or 178468/267702. Solving this problem is equivalent to finding the <em>greatest common divisor</em> (gcd) of the numerator and the denominator: the largest integer which divides them both. A fraction is reduced to lowest terms by dividing both numerator and denominator by their greatest common divisor. An effective method for finding the greatest common divisor was discovered by the ancient Greeks over two thousand years ago: it is called <em>Euclid's algorithm</em> because it is spelled out in Euclid's famous treatise <em>Elements</em>.</p>
<p>Euclid's method is based on the fact that if <em>u</em> is greater than <em>v</em> then the greatest common divisor of <em>u</em> and <em>v</em> is the same as the greatest common divisor of <em>v</em> and <em>u</em> - <em>v</em>. This observation leads to the following implementation in C:</p>
<pre><code class="language-c">#include &lt;stdio.h&gt;

int gcd(int u, int v)
{
  int t;
  while (u &gt; 0)
    {
      if (u &lt; v)
	{ t = u; u = v; v = t; }
      u = u -v;
    }
  return v;
}

main()
{
  int x, y;
  while (scanf("%d %d", &amp;x, &amp;y) != EOF)
    if (x&gt;0 &amp;&amp; y &gt;0)
      printf("%d %d %d\n", x, y, gcd(x,y));
}
</code></pre>
<p>Here is the implementation written in Rust:</p>
<pre><pre class="playground"><code class="language-rust">use std::io;

fn gcd(mut u: u32, mut v: u32) -&gt; u32 {
    let mut t;
    while u &gt; 0 {
        if u &lt; v {
            t = u;
            u = v;
            v = t;
        }
        u = u - v;
    }
    v
}

fn main() {
    for line in io::stdin().lines() {
        let elements: Vec&lt;u32&gt; = line
            .unwrap()
            .split(" ")
            .map(|x| x.parse::&lt;u32&gt;().expect("unable to parse string into i32"))
            .collect();

        match elements.len() {
            2 =&gt; {
                if elements[0] &gt; 0 &amp;&amp; elements[1] &gt; 0 {
                    println!(
                        "gcd({}, {}) =&gt; {}",
                        elements[0],
                        elements[1],
                        gcd(elements[0], elements[1])
                    );
                }
            }
            _ =&gt; println!("The string must be two integers separated by a space"),
        }
    }
}</code></pre></pre>
<h3 id="notes"><a class="header" href="#notes">Notes:</a></h3>
<p>I am not the best with C syntax, but there are some things that we need to cover for both C and Rust before moving on:</p>
<h4 id="copying"><a class="header" href="#copying">Copying</a></h4>
<ol>
<li>In C, functions create local copies of their arguments, so even though <em>x</em> and <em>y</em> are passed into the <em>gcd</em>, their original values are not modified because <em>u</em> and <em>v</em> are not references to <em>x</em> and <em>y</em>.</li>
</ol>
<p>This is why we can write <code>printf("%d %d\n", x, y, gcd(x,y))</code>. In theory, the <em>gcd</em> call gets evaluated before the <em>printf</em> call, so, if <em>x</em> and <em>y</em> were references and not copies, their updated values would have been printed in the <em>printf</em> call.</p>
<p>The Rust code is doing the exact same thing, but the mechanics of why it is happening are slightly different.</p>
<pre><code>println!(
	"gcd({}, {}) =&gt; {}",
    elements[0],
    elements[1],
    gcd(elements[0], elements[1])
);
</code></pre>
<p>Rust has <a href="https://doc.rust-lang.org/stable/book/ch04-01-what-is-ownership.html#ownership-rules"><em>Ownership</em></a>, which can be summed up as follows:</p>
<ul>
<li>Each value in Rust has an owner.</li>
<li>There can only be one owner at a time.</li>
<li>When the owner goes out of scope, the value will be dropped.</li>
</ul>
<p>In general, this means that variables passed to functions and methods or also passing ownership over those varables to functions and methods. I am not sure how things are handled with <code>println!</code> because that is a macro, but, the point remains that if <em>element[0]</em> and <em>element[1]</em> are passed to <em>gcd</em> and <em>gcd</em> gets evaluated first, then the <code>println!</code> macro should have printed the updated values for <em>elements[0]</em> and <em>elements[1]</em>, right? Also, based off the rules of <em>Ownership</em>, it seems like we cannot have two versions of <em>elements[0]</em> and <em>elements[1]</em> around. So, what is going on?</p>
<p>The answer is the <a href="https://doc.rust-lang.org/std/marker/trait.Copy.html"><em>Copy Trait</em></a>. The docs cover a lot, but the gist is that if a struct implements the <em>Copy Trait</em>, then instead of <em>moving into the function</em> (the transfer of ownership) it will <strong>implicitly</strong> create a copy of itself and pass that into the function. The data type <a href="https://doc.rust-lang.org/std/primitive.u32.html#impl-Copy-for-u32">u32</a> implements that <em>Copy Trait</em>, so ownership over <em>elemtns[0]</em> and <em>elements[1]</em> was never transfered because they were never moved.</p>
<h4 id="scanf"><a class="header" href="#scanf">scanf</a></h4>
<p>We do not have <em>scanf</em> in Rust. As a result, I had to scan and parse the input myself, which led to a lot of extra code being added to the main function.</p>
<h3 id="thoughts"><a class="header" href="#thoughts">Thoughts</a></h3>
<p>I really appreciated seeing <em>gcd</em> implemented using subtraction. Previously, I have only seen it implemented using remainder operators or mod operators, which have a direct relationship to subtraction, but I never think of them being on the same level. For example, I can understand someone not knowing modular arithmetic, but I would be completely surprised if they did not know how to subtract. So, for me, seeing this implemented using subtraction is a suble remnder that all this stuff can be written in such basic forms that it is hard to imagine anything of this stuff every being "difficult".</p>

                    </main>

                    <nav class="nav-wrapper" aria-label="Page navigation">
                        <!-- Mobile navigation buttons -->
                            <a rel="prev" href="../chapter_1.html" class="mobile-nav-chapters previous" title="Previous chapter" aria-label="Previous chapter" aria-keyshortcuts="Left">
                                <i class="fa fa-angle-left"></i>
                            </a>

                            <a rel="next prefetch" href="../algortihms_in_c/chapter_3.html" class="mobile-nav-chapters next" title="Next chapter" aria-label="Next chapter" aria-keyshortcuts="Right">
                                <i class="fa fa-angle-right"></i>
                            </a>

                        <div style="clear: both"></div>
                    </nav>
                </div>
            </div>

            <nav class="nav-wide-wrapper" aria-label="Page navigation">
                    <a rel="prev" href="../chapter_1.html" class="nav-chapters previous" title="Previous chapter" aria-label="Previous chapter" aria-keyshortcuts="Left">
                        <i class="fa fa-angle-left"></i>
                    </a>

                    <a rel="next prefetch" href="../algortihms_in_c/chapter_3.html" class="nav-chapters next" title="Next chapter" aria-label="Next chapter" aria-keyshortcuts="Right">
                        <i class="fa fa-angle-right"></i>
                    </a>
            </nav>

        </div>




        <script>
            window.playground_copyable = true;
        </script>


        <script src="../elasticlunr.min.js"></script>
        <script src="../mark.min.js"></script>
        <script src="../searcher.js"></script>

        <script src="../clipboard.min.js"></script>
        <script src="../highlight.js"></script>
        <script src="../book.js"></script>

        <!-- Custom JS scripts -->


    </div>
    </body>
</html>
